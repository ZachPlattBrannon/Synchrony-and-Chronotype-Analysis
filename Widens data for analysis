import pandas as pd

# Example: Load Hume output
# Columns = ['subject', 'frame', 'timestamp', 'team', 
#            'expr1', 'expr2', 'expr3', 'expr1_weight', 'expr2_weight', 'expr3_weight']

hume_df = pd.read_excel('your_hume_output.xlsx')  # Replace with your actual file path

# Define the full list of 37 emotions exactly as Hume uses them
emotion_list = [
    'Adoration', 'Amusement', 'Anger', 'Awe', 'Awkwardness', 'Boredom', 'Calmness',
    'Concentration', 'Confusion', 'Contemplation', 'Contempt', 'Contentment', 'Craving',
    'Desire', 'Determination', 'Disappointment', 'Disgust', 'Distress', 'Doubt', 'Ecstasy',
    'Embarrassment', 'Empathic Pain', 'Entrancement', 'Envy', 'Excitement', 'Fear', 'Guilt',
    'Horror', 'Interest', 'Joy', 'Love', 'Nostalgia', 'Pain', 'Pride', 'Realization', 'Relief', 'Sadness'
]

# Create a new DataFrame with wide format
# First set up the basic columns
wide_df = hume_df[['subject', 'frame', 'timestamp', 'team']].copy()

# Initialize emotion columns to 0
for emotion in emotion_list:
    wide_df[emotion] = 0.0

# Now fill in the weights for expr1, expr2, expr3
for idx, row in hume_df.iterrows():
    # Fill expr1
    expr1 = row['expr1']
    if expr1 in emotion_list:
        wide_df.at[idx, expr1] = row['expr1_weight']
    
    # Fill expr2
    expr2 = row['expr2']
    if expr2 in emotion_list:
        wide_df.at[idx, expr2] = row['expr2_weight']
        
    # Fill expr3
    expr3 = row['expr3']
    if expr3 in emotion_list:
        wide_df.at[idx, expr3] = row['expr3_weight']

# Done! wide_df is now wide format remember to change any later code to "wide_df" instead of df
wide_df.head()
